(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{239:function(e,t,a){e.exports=a(535)},463:function(e,t,a){},464:function(e,t,a){},535:function(e,t,a){"use strict";a.r(t);a(240),a(426);var n=a(1),r=a.n(n),i=a(40),o=a.n(i),l=(a(463),a(15)),s=a(26),u=a(27),c=a(30),m=a(28),d=a(29),p=(a(464),a(465),a(466),a(537)),h=a(538),f=a(540),v=a(539),g=a(233),b=a.n(g),E=a(42),O=a(160),j=a.n(O),k=a(232),y=a.n(k),S="skyblue",w="sandybrown",T="navy",D="darkcyan",C=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(c.a)(this,Object(m.a)(t).call(this)))._leftClickHandler=function(){var t=new Date-864e5*e.state.limit-e.state.page*e.state.limit*864e5,a=Math.abs(e.state.mintemp-t)/864e5<1;e.setState({page:a?e.state.page+1:e.state.page,disableLeft:!a})},e._rightClickHandler=function(){e.setState({page:0===e.state.page?e.state.page:e.state.page-1})},e.updateDimensions=e.updateDimensions.bind(Object(l.a)(Object(l.a)(e))),e._leftClickHandler=e._leftClickHandler.bind(Object(l.a)(Object(l.a)(e))),e.state={temperatures:[],viewportwith:window.innerWidth,limit:100,page:0},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"fetchData",value:function(){var e=this,t=this.state.page,a=this.state.limit;fetch(A+"/temps/search?limit="+a+"&page="+t).then(function(t){t.json().then(function(t){e.setState(function(){var e=t,a=[],n=[],r=[],i=[],o=[];e.map(function(e){var t={};return t.x=new Date(e.TimeStamp).getTime(),t.y=e.Temp_garaaz,a.push(t)}),e.map(function(e){var t={};return t.x=new Date(e.TimeStamp).getTime(),t.y=e.Temp_valjas,n.push(t)}),e.map(function(e){var t={};return t.x=new Date(e.TimeStamp).getTime(),t.y=e.Temp_Leiliruum,i.push(t)}),e.map(function(e){var t={};return t.x=new Date(e.TimeStamp).getTime(),t.y=e.Temp_Eesruum,r.push(t)}),e.map(function(e){var t=new Date(e.TimeStamp).getTime();return o.push(t)});var l=Math.min.apply(Math,o);return{temperatures:t,garaaz:a,valjas:n,eesruum:r,leiliruum:i,mintemp:l}})})})}},{key:"updateDimensions",value:function(){var e=window.innerWidth<800?10:100;this.setState({viewportwith:window.innerWidth,limit:e})}},{key:"componentWillMount",value:function(){this.updateDimensions()}},{key:"componentDidMount",value:function(){console.log("COMPONENT HAS MOUNTED"),window.addEventListener("resize",this.updateDimensions),this.fetchData()}},{key:"componentDidUpdate",value:function(e,t,a){this.state.limit===t.limit&&this.state.page===t.page||this.fetchData()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"render",value:function(){var e=[],t=this.props.garaaz?this.state.garaaz:e,a=this.props.valjas?this.state.valjas:e,n=this.props.eesruum?this.state.eesruum:e,i=this.props.leiliruum?this.state.leiliruum:e,o=0===this.state.page;return r.a.createElement("div",null,r.a.createElement(y.a,{className:"justify-content-between"},r.a.createElement(j.a,{size:"sm",disabled:this.state.nextLeft,variant:"outline-primary",onClick:this._leftClickHandler},"\u2190 Previous Page"),r.a.createElement(j.a,{size:"sm",disabled:o,variant:"outline-primary",onClick:this._rightClickHandler},"Next Page \u2192")),r.a.createElement(E.a,{height:400,margin:{top:10,bottom:80}},r.a.createElement(E.d,null),r.a.createElement(E.b,null),r.a.createElement(E.e,{title:"Aeg",tickFormat:function(e){return"".concat(new Date(e).toLocaleDateString("et",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}))},tickLabelAngle:-45}),r.a.createElement(E.f,{title:"Temp"}),r.a.createElement(E.c,{data:t,color:S}),r.a.createElement(E.c,{data:i,color:D}),r.a.createElement(E.c,{data:n,color:T}),r.a.createElement(E.c,{data:a,color:w})))}}]),t}(n.Component),x=a(73),I=(a(521),{Garaaz:"Garaaz",Test:"Test",Eesruum:"Eesruum"});function H(e,t){return K(e)}function F(e,t){return new Date(parseInt(e)).toLocaleDateString("et",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}var z=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).addTableData=function(e){for(var t=0,n=0,i=(e=a.state.periods).length;n<i;n++)void 0===a.state.filterValue?t+=e[n].period:a.state.filterValue===e[n].room&&(t+=e[n].period);return r.a.createElement("strong",null,"Total: ",K(t))},a.state={periods:[],sortName:void 0,sortOrder:void 0,filterValue:void 0,total:0,footerData:[[{label:"",columnIndex:0},{label:"Total Value",columnIndex:2,align:"right",formatter:function(e){return a.addTableData(e)}}]]},a.onSortChange=a.onSortChange.bind(Object(l.a)(Object(l.a)(a))),a.onFilterChange=a.onFilterChange.bind(Object(l.a)(Object(l.a)(a))),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"onSortChange",value:function(e,t){this.setState({sortName:e,sortOrder:t})}},{key:"onFilterChange",value:function(e){void 0===e.room?this.setState({filterValue:void 0}):this.setState({filterValue:e.room.value})}},{key:"fetchPeriod",value:function(){var e=this;fetch(A+"/period/search?limit=1000&page=0").then(function(t){t.json().then(function(t){e.setState(function(){return{periods:t.map(function(e){return{room:e.Room,start:e.Start,period:e.Period,end:e.End}})}})})})}},{key:"componentDidMount",value:function(){this.fetchPeriod()}},{key:"render",value:function(){var e={sortName:this.state.sortName,sortOrder:this.state.sortOrder,onSortChange:this.onSortChange,onFilterChange:this.onFilterChange,noDataText:"Data query result was empty",defaultSortName:"start",defaultSortOrder:"desc"},t=this.state.footerData;return r.a.createElement(x.BootstrapTable,{data:this.state.periods,options:e,footerData:t,footer:!0,pagination:!0},r.a.createElement(x.TableHeaderColumn,{dataField:"room",dataSort:!0,formatExtraData:I,filter:{type:"SelectFilter",options:I,condition:"eq",defaultValue:"Garaaz"}},"Room"),r.a.createElement(x.TableHeaderColumn,{dataField:"start",isKey:!0,dataSort:!0,dataFormat:F},"Start"),r.a.createElement(x.TableHeaderColumn,{dataField:"period",dataSort:!0,dataFormat:H},"Period"),r.a.createElement(x.TableHeaderColumn,{dataField:"end",dataSort:!0,dataFormat:F},"End"))}}]),t}(n.Component),N=function(e){return r.a.createElement("table",{className:"table table-condensed",style:{fontSize:"12px"}},r.a.createElement("tbody",null,r.a.createElement(L,{data:e.data,onLegendClick:e.onLegendClick})))},L=function(e){var t=e.data,a=t.appProps.leiliruum,n=t.appProps.eesruum,i=t.appProps.valjas,o=t.appProps.garaaz;function l(t){var a={};a.title=t.target.innerText,e.onLegendClick(a)}function s(e){var t={cursor:"pointer",color:"blue"};return"Garaa\u017e"===e.roomId?(t.color=S,t.opacity=o?1:.5):"Eesruum"===e.roomId?(t.color=T,t.opacity=n?1:.5):"Leiliruum"===e.roomId?(t.color=D,t.opacity=a?1:.5):"\xd5ues"===e.roomId?(t.color=w,t.opacity=i?1:.5):t.color="black",t}var u=t.map(function(e){return r.a.createElement("tr",{key:e.Id},r.a.createElement("td",{className:"text-right font-weight-bold",style:s(e),key:e.roomId,onClick:l},e.roomId),r.a.createElement("td",{key:e.temp},e.temp," \xb0C"),r.a.createElement("td",null,"Garaa\u017e"===e.roomId||"Eesruum"===e.roomId||"Test"===e.roomId?e.heat?"Heater On:":"LHP:":""),r.a.createElement("td",null,"Garaa\u017e"===e.roomId||"Eesruum"===e.roomId||"Test"===e.roomId?e.heat?K((new Date).getTime()-e.start):e.start?function(e){return e.end-e.start>0?K(e.end-e.start):""}(e)+" /"+K((new Date).getTime()-e.end)+" Ago":"N/A":""))});return r.a.createElement(r.a.Fragment,null,u)};var _=function(e){function t(e){var a;Object(s.a)(this,t),a=Object(c.a)(this,Object(m.a)(t).call(this,e));var n=A+"/sse";return a.eventSource=new EventSource(n),a.state={roomTemp:[]},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.eventSource.onmessage=function(t){e.updateTempState(JSON.parse(t.data))}}},{key:"updateTempState",value:function(e){var t=[],a={},n=0;for(var r in e)a={roomId:P(r),temp:e[r].temp,heat:e[r].heat,Id:n,start:e[r].HeatStart,end:e[r].HeatEnd},++n,t.push(a);this.setState({roomTemp:t})}},{key:"render",value:function(){var e=this.state.roomTemp;return e.appProps=this.props.appProps,r.a.createElement("div",null,r.a.createElement(N,{data:e,onLegendClick:this.props.onLegendClick}))}}]),t}(n.Component);function P(e){var t="";switch(e){case"28-0517c3a351ff":t="Garaa\u017e";break;case"28-0417c2a85dff":t="Eesruum";break;case"28-0417c28ee3ff":t="\xd5ues";break;case"28-0417c2da95ff":t="Leiliruum";break;case"28-000007d4684f":t="Test"}return t}var A="http://kilde27.hopto.org:4000",M=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r.a.createElement(G,null)}}]),t}(n.Component),G=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e)))._legendClickHandler=function(e){},a._clickHandler=function(e){var t=Object.assign({},a.state);"Garaa\u017e"===e.title?(t.garaaz=!t.garaaz,t.items[0].disabled=!t.items[0].disabled):"Eesruum"===e.title?(t.eesruum=!t.eesruum,t.items[1].disabled=!t.items[1].disabled):"\xd5ues"===e.title?(t.valjas=!t.valjas,t.items[2].disabled=!t.items[2].disabled):"Leiliruum"===e.title&&(t.leiliruum=!t.leiliruum,t.items[3].disabled=!t.items[3].disabled),a.setState(t)},a._clickHandler=a._clickHandler.bind(Object(l.a)(Object(l.a)(a))),a._legendClickHandler=a._legendClickHandler.bind(Object(l.a)(Object(l.a)(a))),a.state={title:"Kilde 27 Garage Temperatures",temperatures:[],leiliruum:!0,eesruum:!0,valjas:!0,garaaz:!0,items:[{title:"Garaa\u017e",disabled:!1},{title:"Eesruum",disabled:!1},{title:"\xd5ues",disabled:!1},{title:"Leiliruum",disabled:!1}]},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.title,t="Edge"!==B()&&"IE"!==B()?r.a.createElement(_,{onLegendClick:this._clickHandler,appProps:this.state}):r.a.createElement("span",null,"IE and Edge don't support SSE. Use other browsers like Chrome to monitor online temperatures");return r.a.createElement(b.a,{className:"App"},r.a.createElement(p.a,{className:"App-header"},r.a.createElement(h.a,{sm:2},r.a.createElement("span",{style:{fontSize:"10px"}},B())),r.a.createElement(h.a,{sm:!0},r.a.createElement("h6",null,e)),r.a.createElement(h.a,{sm:3},r.a.createElement(r.a.Fragment,null,r.a.createElement(W,null)))),r.a.createElement(p.a,null,r.a.createElement(h.a,{sm:9},t),r.a.createElement(h.a,null)),r.a.createElement(p.a,null,r.a.createElement(h.a,null,r.a.createElement(V,{leiliruum:this.state.leiliruum,eesruum:this.state.eesruum,valjas:this.state.valjas,garaaz:this.state.garaaz}))))}}]),t}(n.Component),V=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(m.a)(t).call(this,e,a))).handleSelect=n.handleSelect.bind(Object(l.a)(Object(l.a)(n))),n.state={key:1},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"handleSelect",value:function(e){this.setState({key:e})}},{key:"render",value:function(){var e=this.props.leiliruum,t=this.props.eesruum,a=this.props.valjas,n=this.props.garaaz;return r.a.createElement(f.a,{activeKey:this.state.key,onSelect:this.handleSelect,id:"temptab"},r.a.createElement(v.a,{eventKey:1,title:"Temps"},r.a.createElement(p.a,null,r.a.createElement(h.a,null,r.a.createElement(C,{leiliruum:e,eesruum:t,valjas:a,garaaz:n})))),r.a.createElement(v.a,{eventKey:2,title:"Heatings"},r.a.createElement(z,null)))}}]),t}(r.a.Component);var W=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={serveruptime:""},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(A+"/sst").then(function(t){t.json().then(function(t){e.setState(function(){return{serveruptime:t.server,nodeuptime:t.node}})})})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(U,{data:this.state}))}}]),t}(r.a.Component),U=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(c.a)(this,Object(m.a)(t).call(this,e))).state={time:K((new Date).getTime()-new Date(a.props.data.nodeuptime).getTime()),stime:K((new Date).getTime()-new Date(a.props.data.serveruptime).getTime())},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.intervalID=setInterval(function(){return e.tick()},1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalID)}},{key:"tick",value:function(){this.setState({time:K((new Date).getTime()-new Date(this.props.data.nodeuptime).getTime()),stime:K((new Date).getTime()-new Date(this.props.data.serveruptime).getTime())})}},{key:"render",value:function(){return r.a.createElement("table",{className:"table table_condensed",style:{fontSize:"10px",color:"white"}},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"text-right"},"Node UpTime:"),r.a.createElement("td",null,this.state.time),r.a.createElement("td",{className:"text-right"},"Server UpTime:"),r.a.createElement("td",null,this.state.stime))))}}]),t}(r.a.Component);function K(e){var t=(e/1e3).toFixed(1),a=(e/6e4).toFixed(1),n=(e/36e5).toFixed(1),r=(e/864e5).toFixed(1);return t<60?t+" Sec":a<60?a+" Min":n<24?n+" Hrs":r+" Days"}function B(){return navigator.userAgent.indexOf("Edge")>-1&&navigator.appVersion.indexOf("Edge")>-1?"Edge":-1!==navigator.userAgent.indexOf("Opera")||-1!==navigator.userAgent.indexOf("OPR")?"Opera":-1!==navigator.userAgent.indexOf("Chrome")?"Chrome":-1!==navigator.userAgent.indexOf("Safari")?"Safari":-1!==navigator.userAgent.indexOf("Firefox")?"Firefox":-1!==navigator.userAgent.indexOf("MSIE")||!0===!!document.documentMode?"IE":"unknown"}var J=M;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[239,1,2]]]);
//# sourceMappingURL=main.2d43aa9a.chunk.js.map